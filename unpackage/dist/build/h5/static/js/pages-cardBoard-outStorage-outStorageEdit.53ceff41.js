(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["pages-cardBoard-outStorage-outStorageEdit"],{"5c12":function(t,e,n){e=t.exports=n("2350")(!1),e.push([t.i,".margin-text-center[data-v-274eab55]{text-align:center;margin:%?20?%}.border-top[data-v-274eab55]{border-top:1px solid #eee}.cu-form-group .title[data-v-274eab55]{min-width:calc(4em + 15px)}",""])},"7a11":function(t,e,n){var i=n("5c12");"string"===typeof i&&(i=[[t.i,i,""]]),i.locals&&(t.exports=i.locals);var r=n("4f06").default;r("4bb9ad4f",i,!0,{sourceMap:!1,shadowMode:!1})},"7bed":function(t,e,n){"use strict";n.r(e);var i=n("9120"),r=n("d6f0");for(var s in r)"default"!==s&&function(t){n.d(e,t,function(){return r[t]})}(s);n("9efa");var a=n("2877"),o=Object(a["a"])(r["default"],i["a"],i["b"],!1,null,"274eab55",null);e["default"]=o.exports},9120:function(t,e,n){"use strict";var i=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("v-uni-view",[n("cu-custom",{attrs:{bgColor:"bg-gradual-blue",isBack:!0}},[n("template",{attrs:{slot:"content"},slot:"content"},[t._v("保存出仓")])],2),n("v-uni-form",[n("v-uni-view",{ref:"elForm",staticClass:"elForm"},[n("v-uni-view",{staticClass:"cu-form-group border-top"},[n("v-uni-view",{staticClass:"title"},[t._v("车牌:")]),n("v-uni-input",{attrs:{disabled:"",placeholder:"请选择车牌",name:"input"},on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.setSearchDataListSource("LicensePlate")}},model:{value:t.formItem.LicensePlate,callback:function(e){t.$set(t.formItem,"LicensePlate",e)},expression:"formItem.LicensePlate"}}),n("v-uni-text",{staticClass:"cuIcon-rounddown text-green",on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.setSearchDataListSource("LicensePlate")}}})],1),n("v-uni-view",{staticClass:"cu-form-group border-top"},[n("v-uni-view",{staticClass:"title"},[t._v("司机:")]),n("v-uni-input",{attrs:{disabled:"",placeholder:"请选择司机",name:"input"},on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.setSearchDataListSource("driver")}},model:{value:t.formItem.driver,callback:function(e){t.$set(t.formItem,"driver",e)},expression:"formItem.driver"}}),n("v-uni-text",{staticClass:"cuIcon-rounddown text-green",on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.setSearchDataListSource("driver")}}})],1),n("v-uni-view",{staticClass:"cu-form-group border-top"},[n("v-uni-view",{staticClass:"title"},[t._v("装车:")]),n("v-uni-input",{attrs:{disabled:"",placeholder:"请选择装车",name:"input"},on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.setSearchDataListSource("entrucking")}},model:{value:t.formItem.entrucking,callback:function(e){t.$set(t.formItem,"entrucking",e)},expression:"formItem.entrucking"}}),n("v-uni-text",{staticClass:"cuIcon-rounddown text-green",on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.setSearchDataListSource("entrucking")}}})],1),n("v-uni-view",{staticClass:"cu-form-group border-top"},[n("v-uni-view",{staticClass:"title"},[t._v("发货:")]),n("v-uni-input",{attrs:{disabled:"",placeholder:"请选择发货",name:"input"},on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.setSearchDataListSource("sendGoods")}},model:{value:t.formItem.sendGoods,callback:function(e){t.$set(t.formItem,"sendGoods",e)},expression:"formItem.sendGoods"}}),n("v-uni-text",{staticClass:"cuIcon-rounddown text-green",on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.setSearchDataListSource("sendGoods")}}})],1),n("v-uni-view",{staticClass:"cu-form-group margin-top"},[n("v-uni-view",{staticClass:"title"},[t._v("自提")]),n("v-uni-switch",{class:t.formItem.isSelfTake?"checked":"",attrs:{checked:!!t.formItem.isSelfTake},on:{change:function(e){arguments[0]=e=t.$handleEvent(e),t.isSelfTakeChange.apply(void 0,arguments)}}})],1),n("v-uni-view",{staticClass:"cu-form-group margin-top"},[n("v-uni-view",{staticClass:"title"},[t._v("送货日期")]),n("v-uni-picker",{attrs:{mode:"date",value:t.formItem.deliverDate,start:"2015-09-01",end:"2020-09-01"},on:{change:function(e){arguments[0]=e=t.$handleEvent(e),t.DateChange.apply(void 0,arguments)}}},[n("v-uni-view",{staticClass:"picker"},[t._v(t._s(t.formItem.deliverDate))])],1)],1)],1)],1),n("v-uni-view",{style:[{height:t.tableHeight-10+"px"}]}),n("v-uni-view",{ref:"elBtn",staticClass:"elBtn margin-text-center"},[n("v-uni-view",{staticClass:"text-red"},[n("v-uni-text",[t._v("保存出仓自动生成送货单，\n\t\t\t\t\t\t 不能再进行修改，\n\t\t\t\t\t\t 如需修改明细请于ERP送货单中进行修改"),n("p",{staticStyle:{"margin-top":"20rpx"}})])],1),n("v-uni-view",{staticClass:"flex  p-xs "},[n("v-uni-view",{staticClass:"flex-twice  radius"}),n("v-uni-view",{staticClass:"flex-sub radius"}),n("v-uni-view",{staticClass:"flex-twice  radius"},[n("v-uni-button",{staticClass:"cu-btn block bg-green  lg",attrs:{loading:!1,disabled:!t.canSubmit||""==t.CarListNo||""==t.formItem.LicensePlate||""==t.formItem.entrucking||""==t.formItem.driver||""==t.formItem.sendGoods,type:""},on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.aspCarListAppAppend(t.saveWarehouses)}}},[t._v("保存出仓")])],1)],1)],1),n("alertBox",{ref:"alertBox",attrs:{msgContent:t.msgContent,toShowModal:t.toShowModal},on:{cancelModal:function(e){arguments[0]=e=t.$handleEvent(e),t.cancelModal.apply(void 0,arguments)},comfirmModal:function(e){arguments[0]=e=t.$handleEvent(e),t.comfirmModal.apply(void 0,arguments)}}}),n("searchForm",{ref:"searchForm",attrs:{dataSource:t.dataSource},on:{getSelectDataInfo:function(e){arguments[0]=e=t.$handleEvent(e),t.getSelectDataInfo.apply(void 0,arguments)}}})],1)},r=[];n.d(e,"a",function(){return i}),n.d(e,"b",function(){return r})},"9efa":function(t,e,n){"use strict";var i=n("7a11"),r=n.n(i);r.a},d6f0:function(t,e,n){"use strict";n.r(e);var i=n("fe4c"),r=n.n(i);for(var s in i)"default"!==s&&function(t){n.d(e,t,function(){return i[t]})}(s);e["default"]=r.a},dcad:function(t,e,n){"use strict";n("6b54"),n("4917"),n("28a5"),n("a481"),n("c5f6"),function(e,n){t.exports=n()}(0,function(){var t="millisecond",e="second",n="minute",i="hour",r="day",s="week",a="month",o="quarter",c="year",u=/^(\d{4})-?(\d{1,2})-?(\d{0,2})[^0-9]*(\d{1,2})?:?(\d{1,2})?:?(\d{1,2})?.?(\d{1,3})?$/,d=/\[([^\]]+)]|Y{2,4}|M{1,4}|D{1,2}|d{1,4}|H{1,2}|h{1,2}|a|A|m{1,2}|s{1,2}|Z{1,2}|SSS/g,l=function(t,e,n){var i=String(t);return!i||i.length>=e?t:""+Array(e+1-i.length).join(n)+t},f={s:l,z:function(t){var e=-t.utcOffset(),n=Math.abs(e),i=Math.floor(n/60),r=n%60;return(e<=0?"+":"-")+l(i,2,"0")+":"+l(r,2,"0")},m:function(t,e){var n=12*(e.year()-t.year())+(e.month()-t.month()),i=t.clone().add(n,a),r=e-i<0,s=t.clone().add(n+(r?-1:1),a);return Number(-(n+(e-i)/(r?i-s:s-i))||0)},a:function(t){return t<0?Math.ceil(t)||0:Math.floor(t)},p:function(u){return{M:a,y:c,w:s,d:r,h:i,m:n,s:e,ms:t,Q:o}[u]||String(u||"").toLowerCase().replace(/s$/,"")},u:function(t){return void 0===t}},h={name:"en",weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_")},m="en",v={};v[m]=h;var p=function(t){return t instanceof D},g=function(t,e,n){var i;if(!t)return m;if("string"==typeof t)v[t]&&(i=t),e&&(v[t]=e,i=t);else{var r=t.name;v[r]=t,i=r}return n||(m=i),i},$=function(t,e,n){if(p(t))return t.clone();var i=e?"string"==typeof e?{format:e,pl:n}:e:{};return i.date=t,new D(i)},S=f;S.l=g,S.i=p,S.w=function(t,e){return $(t,{locale:e.$L,utc:e.$u})};var D=function(){function l(t){this.$L=this.$L||g(t.locale,null,!0),this.parse(t)}var f=l.prototype;return f.parse=function(t){this.$d=function(t){var e=t.date,n=t.utc;if(null===e)return new Date(NaN);if(S.u(e))return new Date;if(e instanceof Date)return new Date(e);if("string"==typeof e&&!/Z$/i.test(e)){var i=e.match(u);if(i)return n?new Date(Date.UTC(i[1],i[2]-1,i[3]||1,i[4]||0,i[5]||0,i[6]||0,i[7]||0)):new Date(i[1],i[2]-1,i[3]||1,i[4]||0,i[5]||0,i[6]||0,i[7]||0)}return new Date(e)}(t),this.init()},f.init=function(){var t=this.$d;this.$y=t.getFullYear(),this.$M=t.getMonth(),this.$D=t.getDate(),this.$W=t.getDay(),this.$H=t.getHours(),this.$m=t.getMinutes(),this.$s=t.getSeconds(),this.$ms=t.getMilliseconds()},f.$utils=function(){return S},f.isValid=function(){return!("Invalid Date"===this.$d.toString())},f.isSame=function(t,e){var n=$(t);return this.startOf(e)<=n&&n<=this.endOf(e)},f.isAfter=function(t,e){return $(t)<this.startOf(e)},f.isBefore=function(t,e){return this.endOf(e)<$(t)},f.$g=function(t,e,n){return S.u(t)?this[e]:this.set(n,t)},f.year=function(t){return this.$g(t,"$y",c)},f.month=function(t){return this.$g(t,"$M",a)},f.day=function(t){return this.$g(t,"$W",r)},f.date=function(t){return this.$g(t,"$D","date")},f.hour=function(t){return this.$g(t,"$H",i)},f.minute=function(t){return this.$g(t,"$m",n)},f.second=function(t){return this.$g(t,"$s",e)},f.millisecond=function(e){return this.$g(e,"$ms",t)},f.unix=function(){return Math.floor(this.valueOf()/1e3)},f.valueOf=function(){return this.$d.getTime()},f.startOf=function(t,o){var u=this,d=!!S.u(o)||o,l=S.p(t),f=function(t,e){var n=S.w(u.$u?Date.UTC(u.$y,e,t):new Date(u.$y,e,t),u);return d?n:n.endOf(r)},h=function(t,e){return S.w(u.toDate()[t].apply(u.toDate(),(d?[0,0,0,0]:[23,59,59,999]).slice(e)),u)},m=this.$W,v=this.$M,p=this.$D,g="set"+(this.$u?"UTC":"");switch(l){case c:return d?f(1,0):f(31,11);case a:return d?f(1,v):f(0,v+1);case s:var $=this.$locale().weekStart||0,D=(m<$?m+7:m)-$;return f(d?p-D:p+(6-D),v);case r:case"date":return h(g+"Hours",0);case i:return h(g+"Minutes",1);case n:return h(g+"Seconds",2);case e:return h(g+"Milliseconds",3);default:return this.clone()}},f.endOf=function(t){return this.startOf(t,!1)},f.$set=function(s,o){var u,d=S.p(s),l="set"+(this.$u?"UTC":""),f=(u={},u[r]=l+"Date",u.date=l+"Date",u[a]=l+"Month",u[c]=l+"FullYear",u[i]=l+"Hours",u[n]=l+"Minutes",u[e]=l+"Seconds",u[t]=l+"Milliseconds",u)[d],h=d===r?this.$D+(o-this.$W):o;if(d===a||d===c){var m=this.clone().set("date",1);m.$d[f](h),m.init(),this.$d=m.set("date",Math.min(this.$D,m.daysInMonth())).toDate()}else f&&this.$d[f](h);return this.init(),this},f.set=function(t,e){return this.clone().$set(t,e)},f.get=function(t){return this[S.p(t)]()},f.add=function(t,o){var u,d=this;t=Number(t);var l=S.p(o),f=function(e){var n=$(d);return S.w(n.date(n.date()+Math.round(e*t)),d)};if(l===a)return this.set(a,this.$M+t);if(l===c)return this.set(c,this.$y+t);if(l===r)return f(1);if(l===s)return f(7);var h=(u={},u[n]=6e4,u[i]=36e5,u[e]=1e3,u)[l]||1,m=this.valueOf()+t*h;return S.w(m,this)},f.subtract=function(t,e){return this.add(-1*t,e)},f.format=function(t){var e=this;if(!this.isValid())return"Invalid Date";var n=t||"YYYY-MM-DDTHH:mm:ssZ",i=S.z(this),r=this.$locale(),s=this.$H,a=this.$m,o=this.$M,c=r.weekdays,u=r.months,l=function(t,i,r,s){return t&&(t[i]||t(e,n))||r[i].substr(0,s)},f=function(t){return S.s(s%12||12,t,"0")},h=r.meridiem||function(t,e,n){var i=t<12?"AM":"PM";return n?i.toLowerCase():i},m={YY:String(this.$y).slice(-2),YYYY:this.$y,M:o+1,MM:S.s(o+1,2,"0"),MMM:l(r.monthsShort,o,u,3),MMMM:u[o]||u(this,n),D:this.$D,DD:S.s(this.$D,2,"0"),d:String(this.$W),dd:l(r.weekdaysMin,this.$W,c,2),ddd:l(r.weekdaysShort,this.$W,c,3),dddd:c[this.$W],H:String(s),HH:S.s(s,2,"0"),h:f(1),hh:f(2),a:h(s,a,!0),A:h(s,a,!1),m:String(a),mm:S.s(a,2,"0"),s:String(this.$s),ss:S.s(this.$s,2,"0"),SSS:S.s(this.$ms,3,"0"),Z:i};return n.replace(d,function(t,e){return e||m[t]||i.replace(":","")})},f.utcOffset=function(){return 15*-Math.round(this.$d.getTimezoneOffset()/15)},f.diff=function(t,u,d){var l,f=S.p(u),h=$(t),m=6e4*(h.utcOffset()-this.utcOffset()),v=this-h,p=S.m(this,h);return p=(l={},l[c]=p/12,l[a]=p,l[o]=p/3,l[s]=(v-m)/6048e5,l[r]=(v-m)/864e5,l[i]=v/36e5,l[n]=v/6e4,l[e]=v/1e3,l)[f]||v,d?p:S.a(p)},f.daysInMonth=function(){return this.endOf(a).$D},f.$locale=function(){return v[this.$L]},f.locale=function(t,e){if(!t)return this.$L;var n=this.clone();return n.$L=g(t,e,!0),n},f.clone=function(){return S.w(this.toDate(),this)},f.toDate=function(){return new Date(this.$d)},f.toJSON=function(){return this.isValid()?this.toISOString():null},f.toISOString=function(){return this.$d.toISOString()},f.toString=function(){return this.$d.toUTCString()},l}();return $.prototype=D.prototype,$.extend=function(t,e){return t(e,D,$),$},$.locale=g,$.isDayjs=p,$.unix=function(t){return $(1e3*t)},$.en=v[m],$.Ls=v,$})},fe4c:function(t,e,n){"use strict";var i=n("288e");Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0,n("96cf");var r=i(n("3b8d")),s=i(n("795b")),a=i(n("cebc")),o=i(n("5176")),c=i(n("0a0d")),u=i(n("0a5c")),d=i(n("dcad")),l=i(n("43f7")),f=i(n("717c")),h=i(n("6203")),m=i(n("a99d")),v=i(n("2464")),p=n("2f62"),g=i(n("ad32")),$={entrucking:"",entruckingID:"",sendGoods:"",SenderID:"",deliverDate:(0,d.default)((0,c.default)()).format("YYYY-MM-DD"),isSelfTake:!1,LicensePlate:"",driver:"",driverID:""},S={name:"inStorage",mixins:[v.default],components:{zTable:f.default,searchForm:m.default,uniPopup:g.default,uniIcon:h.default,alertBox:l.default},data:function(){return{canSubmit:!0,currentAction:"",CarListNo:"",toShowModal:!1,msgContent:"",dataSource:[],currentSelect:"driver",tableHeight:400,licensePlateList:[],driverList:[],entruckingList:[],sendGoodsList:[],formItem:(0,o.default)({},$)}},onLoad:function(t){this.CarListNo=t.carListNo},mounted:function(){this.messageRegister(),this.getTableHeight()},methods:(0,a.default)({comfirmModal:function(t){switch(this.toShowModal=!1,this.currentAction){case"sendPrintActionToERP":this.sendPrintActionToERP();break;default:break}},cancelModal:function(t){this.toShowModal=!1},sendPrintActionToERP:function(){var t=this.$store.getters.userObjInfo_getters,e=t.ip,n=t.port,i=t.UserID,r="http://".concat(e,":").concat(n,"/indexhtml?userID=").concat(i,",LoadCarNo=").concat(this.CarListNo),a={};return new s.default(function(t,e){u.default.request({"Content-Type":"application/json;charset=UTF-8",url:r,data:a,method:"POST"}).then(function(e){e&&t(e)}).catch(function(t){t&&e(t)})})}},(0,p.mapActions)(["spCreatePaperCarListAppAction","getAspCarListAppAppendAction"]),{saveWarehouses:function(){var t=this,e={procName:"spSaveCarListToDeliForAPP",params:{UserID:this.$store.getters.userInfo_getters,CarListNo:this.CarListNo,CarNo:this.formItem.LicensePlate,Chauffeur:this.formItem.driverID,Loador:this.formItem.entruckingID,SenderID:this.formItem.SenderID,IsZT:1==this.formItem.isSelfTake?1:0,ADate:this.formItem.deliverDate+" "+(0,d.default)((0,c.default)()).format("HH:mm:ss")}};this.$store.dispatch("setWarehousesAction",e).then(function(e){t.canSubmit=!1,uni.showToast({title:"保存出仓成功",icon:"none",duration:2e3}),uni.removeStorage({key:"outInCarList",success:function(t){console.log("success")}})}).catch(function(t){uni.showToast({title:"保存出仓失败:"+t,icon:"none",duration:2e3})})},aspCarListAppAppend:function(t){var e;try{var n="outInCarList";e=uni.getStorageSync(n),e&&console.log(e)}catch(r){}var i={UserID:this.$store.getters.userInfo_getters,list:e};this.$store.dispatch("spCreatePaperCarListAppAction",i).then(function(e){t&&t()}).catch(function(t){uni.showToast({title:"保存出仓失败:"+t,icon:"none",duration:2e3})})},isSelfTakeChange:function(t){this.formItem.isSelfTake=t.detail.value},formatMultipleVal:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"desc",n="";t.map(function(t){""==n?n="desc"==e?t.ct_Desc:t.type:n+="desc"==e?";"+t.ct_Desc:";"+t.type});return n},getSelectDataInfo:function(t){switch(this.currentSelect){case"LicensePlate":this.formItem.LicensePlate=t.ct_Desc;break;case"driver":this.formItem.driverID=t.type,this.formItem.driver=t.ct_Desc;break;case"entrucking":this.formItem.entruckingID=this.formatMultipleVal(t,"type"),this.formItem.entrucking=this.formatMultipleVal(t,"desc");break;case"sendGoods":this.formItem.SenderID=t.type,this.formItem.sendGoods=t.ct_Desc;default:break}},setSearchDataListSource:function(t){this.currentSelect=t,this.$refs["searchForm"].isMultipel=!1,this.$refs["searchForm"].isShowSearchList=!0,"LicensePlate"===t?(this.dataSource=this.licensePlateList,this.$refs["searchForm"].dataSourceList=this.licensePlateList):"driver"===t?(this.dataSource=this.driverList,this.$refs["searchForm"].dataSourceList=this.driverList):"entrucking"===t?(this.$refs["searchForm"].isMultipel=!0,this.dataSource=this.entruckingList,this.$refs["searchForm"].dataSourceList=this.entruckingList):"sendGoods"===t&&(this.dataSource=this.sendGoodsList,this.$refs["searchForm"].dataSourceList=this.sendGoodsList)},loadLicensePlateList:function(){var t=this;this.licensePlateList=[];var e={};this.$store.dispatch("getLicensePlateListAction",e).then(function(e){if(e){var n=e.map(function(t){var e={type:t.CarNo,ct_Desc:t.CarNo};return e});t.licensePlateList=n}}).catch(function(t){uni.showToast({title:"加载车牌列表失败:"+t,icon:"none",duration:2e3})})},loadDriverList:function(){var t=this;this.driverList=[];var e={};this.$store.dispatch("getDriverListAction",e).then(function(e){if(e){var n=e.map(function(t){var e={type:t.ID,ct_Desc:t.Name};return e});t.driverList=n}}).catch(function(t){uni.showToast({title:"加载司机列表失败:"+t,icon:"none",duration:2e3})})},loadEntruckingList:function(){var t=this;this.entruckingList=[];var e={};this.$store.dispatch("getEntruckingListAction",e).then(function(e){if(e){var n=e.map(function(t){var e={type:t.ID,ct_Desc:t.Name};return e});t.entruckingList=n}}).catch(function(t){uni.showToast({title:"加载装货列表失败:"+t,icon:"none",duration:2e3})})},loadsendGoodsList:function(){var t=this;this.sendGoodsList=[];var e={};this.$store.dispatch("getSendGoodsListAction",e).then(function(e){if(e){var n=e.map(function(t){var e={type:t.ID,ct_Desc:t.Name};return e});t.sendGoodsList=n}}).catch(function(t){uni.showToast({title:"加载发货列表失败:"+t,icon:"none",duration:2e3})})},DateChange:function(t){this.formItem.deliverDate=t.detail.value},getTableHeight:function(){var t=(0,r.default)(regeneratorRuntime.mark(function t(){var e,n,i,r;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return e=this,n=e.setTableHeight(),t.next=4,e.getOtherContentHeight("elForm");case 4:return i=t.sent,t.next=7,e.getOtherContentHeight("elBtn");case 7:r=t.sent,null!=i&&null!=r&&(e.tableHeight=n-i-r-20);case 9:case"end":return t.stop()}},t,this)}));function e(){return t.apply(this,arguments)}return e}()},(0,p.mapActions)(["getClassBanListAction"]),{messageRegister:function(){this.canSubmit=!0,this.loadLicensePlateList(),this.loadDriverList(),this.loadEntruckingList(),this.loadsendGoodsList()},turnOnScanCode:function(t){this.scanType=t;var e=this;uni.scanCode({scanType:"barCode",success:function(n){switch(console.log("条码内容："+n.result),t){case"cardBoardNo":e.formItem.cardBoardNo=n.result;break;case"kuNo":e.formItem.kuNo=n.result;break;default:break}}})}})};e.default=S}}]);