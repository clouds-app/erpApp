(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["pages-cardBoard-outStorage-outStorage"],{"0dc8":function(t,o,e){"use strict";e.r(o);var a=e("45c4"),n=e("392c");for(var i in n)"default"!==i&&function(t){e.d(o,t,function(){return n[t]})}(i);e("ba8a");var r=e("2877"),s=Object(r["a"])(n["default"],a["a"],a["b"],!1,null,"225b577c",null);o["default"]=s.exports},"37ec":function(t,o,e){"use strict";var a=e("288e");Object.defineProperty(o,"__esModule",{value:!0}),o.default=void 0,e("7514");var n=a(e("a4bb"));e("96cf");var i=a(e("3b8d"));e("ac6a");var r=a(e("f499")),s=a(e("cebc")),c=a(e("5176")),d=a(e("43f7")),l=a(e("717c")),u=a(e("6203")),h=a(e("a99d")),f=a(e("2464")),p=e("2f62"),v=a(e("ad32")),m={cardBoardNo:"",carGoodsNo:""},g={name:"inStorage",mixins:[f.default],components:{zTable:l.default,searchForm:h.default,uniPopup:v.default,uniIcon:u.default,alertBox:d.default},data:function(){return{appendModel:{OrderNo:""},appendRow:{},appendModalShow:!1,appendOkBtnDisabled:!0,scanCard:{},currentAction:"",currentSelectId:"",currentSelectItem:{},currentSelect:"carNoList",dataSource:[],toShowModal:!1,msgContent:"",scanType:"",tableHeight:400,carNoList:[],errorContent:"暂无数据",cardBoardNoInfoData:[],cardBoardNoInfoClone:{},cardBoardNoInfoColumns:[{key:"CustName",title:"客户",width:120},{key:"OrderNo",title:"工单号",width:180},{key:"StationNo",title:"库位",width:100},{key:"Qty",title:"需装数",width:120},{key:"ScanQty",title:"扫描数",width:120},{key:"ArtID",title:"纸质",width:200},{key:"Size",title:"规格",width:200},{key:"MinSize",title:"小尺寸",width:200},{key:"ZoneName",title:"地区",width:200},{title:"操作",listenerClick:!0,width:130,titleAlign:"center",columnAlign:"center",format:{template:"详细",names:[]}}],formItem:(0,c.default)({},m),catchFlag:!1,cardScanQtyItems:{}}},watch:{cardBoardNoInfoData:{handler:function(t,o){},deep:!0}},mounted:function(){var t=this;uni.$on("outInCarListUpdate",function(o){t.cardBoardNoInfoClone[o.orderNo]&&(t.cardBoardNoInfoClone[o.orderNo].ScanQty=o.scanQty)}),this.messageRegister(),this.getTableHeight()},methods:(0,s.default)({getWorkNoInfo:function(){},goToOtherPage:function(){if(""==this.formItem.carGoodsNo)uni.showToast({title:"请先选择需要操作的装车单号",icon:"none",duration:2e3});else{var t="outInCarList";try{uni.removeStorageSync(t)}catch(e){return this.catchFlag=!1,void console.log(e)}try{var o=this;uni.setStorage({key:t,data:o.cardBoardNoInfoData,success:function(){o.catchFlag=!0}})}catch(e){this.catchFlag=!1}if(!this.catchFlag)return void uni.showToast({title:"数据缓存失败,请稍后再试!",icon:"none",duration:2e3});uni.navigateTo({url:"./outStorageEdit?carListNo="+this.formItem.carGoodsNo})}},moreDetail:function(){uni.navigateTo({url:"./outStorageDetail?carListNo="+this.formItem.carGoodsNo})},onClickCheck:function(t){},onClickRowEvent:function(t){console.log(t);var o="cardQtyListCache";try{uni.removeStorageSync(o)}catch(a){return this.catchFlag=!1,void console.log(a)}try{var e=this;uni.setStorage({key:o,data:(0,r.default)(e.cardScanQtyItems),success:function(){}})}catch(a){console.log(a)}uni.navigateTo({url:"./outStorageDetail?orderNo=".concat(t.OrderNo,"&cardNo=").concat(t.CardNo,"&scanQty=").concat(t.ScanQty,"&cacheKey=").concat(o)})},deleteDetailItem:function(t){var o={id:t};this.$store.dispatch("delateStockUpDetailedAction",o).then(function(t){uni.showToast({title:"删除成功!",icon:"none",duration:2e3})}).catch(function(t){uni.showToast({title:"删除失败:"+t,icon:"none",duration:2e3})})},getCardBoardNoInfo:function(){var t=this;if(this.cardBoardNoInfoData=[],""!=this.formItem.carGoodsNo){var o={procName:"spGetPaperCarListInfoForAPP",params:{UserID:this.$store.getters.userInfo_getters,CarListNo:this.formItem.carGoodsNo}};this.dataIsLoadding=!0,this.getExecuteDropDownDetailsAction(o).then(function(o){o&&o.list.length>0?(t.cardBoardNoInfoData=o.list,t.formItem.originalKuNo=t.cardBoardNoInfoData[0].ap_StationNo,t.cardBoardNoInfoData.forEach(function(o,e){t.cardBoardNoInfoClone[o.OrderNo]=o})):uni.showToast({title:"没有该卡板对应的数据",icon:"none",duration:2e3}),t.dataIsLoadding=!1}).catch(function(o){uni.showToast({title:"获取清单数据失败:"+o,icon:"none",duration:2e3}),t.dataIsLoadding=!1})}else uni.showToast({title:"请选择装车单号",icon:"none",duration:2e3})},getSelectDataInfo:function(t){switch(this.currentSelect){case"carNoList":this.formItem.carGoodsNo=t.ct_Desc,this.getCardBoardNoInfo();break;default:break}this.scanCard={}},getCarGoodsNo:function(){this.$refs["searchForm"].isShowSearchList=!0,this.$refs["searchForm"].dataSourceList=this.carNoList,this.dataSource=this.carNoList},loadCarGoodsNoList:function(){this.carNoList=[];var t={procName:"spGetLoadCarNoListForAPP",params:{UserID:this.$store.getters.userInfo_getters}},o=this;this.$store.dispatch("getExecuteDropDownAction",t).then(function(t){if(t&&t.list&&t.list.length>0){var e=t.list.map(function(t){var o={type:t.LoadNo,ct_Desc:t.LoadNo};return o});o.carNoList=e}}).catch(function(t){uni.showToast({title:"加载装车单号列表失败:"+t,icon:"none",duration:2e3})})},comfirmModal:function(t){switch(this.toShowModal=!1,this.currentAction){case"preSubmitDataList":this.submitAddList();break;case"deleteDetailItem":this.deleteDetailItem(this.currentSelectItem.ap_OrderNo);break;default:break}},cancelModal:function(t){this.toShowModal=!1},preSubmitDataList:function(){this.currentAction="preSubmitDataList",this.msgContent="确定提交数据吗?",this.toShowModal=!0},submitAddList:function(){var t=this,o={newStationNo:this.formItem.kuNo,StationNo:this.cardBoardNoInfoData[0].ap_StationNo};this.$store.dispatch("setStationNoAction",o).then(function(o){t.formItem=(0,c.default)({},defalutformItem),t.cardBoardNoInfoData=[],uni.showToast({title:"操作成功",icon:"none",duration:2e3})}).catch(function(t){uni.showToast({title:"操作失败:"+t,icon:"none",duration:2e3})})},getTableHeight:function(){var t=(0,i.default)(regeneratorRuntime.mark(function t(){var o,e,a,n;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return o=this,e=o.setTableHeight(),t.next=4,o.getOtherContentHeight("elForm");case 4:return a=t.sent,t.next=7,o.getOtherContentHeight("elBtn");case 7:n=t.sent,null!=a&&null!=n&&(o.tableHeight=e-a-n-20);case 9:case"end":return t.stop()}},t,this)}));function o(){return t.apply(this,arguments)}return o}()},(0,p.mapActions)(["getExecuteDropDownDetailsAction","getStorageOrderDetailAction"]),{messageRegister:function(){this.$store.commit("setOutStorageDetailsList",[]),this.loadCarGoodsNoList()},getcardBoarDetailList:function(){var t={procName:"spFreshCarListForAPP",params:{CardNo:this.formItem.cardBoardNo,UserID:this.$store.getters.userInfo_getters,CarListNo:this.formItem.carGoodsNo}};this.$store.dispatch("getExecuteDropDownAction",t).then(function(t){console.log(t),uni.showToast({title:"更新明细成功,请稍后...",icon:"none",duration:2e3})}).catch(function(t){uni.showToast({title:"抱歉,更新明细失败:"+t,icon:"none",duration:2e3})})},turnOnScanCode:function(t){this.scanType=t;var o=this;uni.scanCode({scanType:"barCode",success:function(e){switch(console.log("条码内容："+e.result),t){case"cardBoardNo":o.formItem.cardBoardNo=e.result,o.spFreshCarListForAPP();break;case"OrderNo":o.appendModel.OrderNo=e.result;break;default:break}}})},getStorageOrderDetail:function(){var t=this;""!=this.appendModel.OrderNo&&this.$store.dispatch("getStorageOrderDetailAction",this.appendModel).then(function(o){o.list.length>0?(t.appendRow=o.list[0],t.appendOkBtnDisabled=!1):(t.appendModel.OrderNo="",uni.showToast({title:"该工单没有对应的信息",icon:"none",duration:2e3}))}).catch(function(t){uni.showToast({title:"抱歉,工单明细获取失败,请稍后再试",icon:"none",duration:2e3})})},appendRowToList:function(){var t=this;if(0!=(0,n.default)(this.appendRow).length){var o=this.cardBoardNoInfoData.find(function(o){return o.OrderNo==t.appendModel.OrderNo});o?uni.showToast({title:"工单已在当前列表中存在",icon:"none",duration:2e3}):this.cardBoardNoInfoData.push(this.appendRow),this.closeAppendModal()}else uni.showToast({title:"请输入工单号,稍等片刻",icon:"none",duration:2e3})},closeAppendModal:function(){this.appendRow={},this.appendModel.OrderNo="",this.appendOkBtnDisabled=!0,this.appendModalShow=!1},spFreshCarListForAPP:function(){var t=this;if(""!=this.formItem.cardBoardNo){var o=""+this.formItem.cardBoardNo;if(this.scanCard[o])return uni.showToast({title:"".concat(this.formItem.cardBoardNo,"卡板号已经被扫描了"),icon:"none",duration:2e3}),void(this.formItem.cardBoardNo="");var e={procName:"spFreshCarListForAPP",params:{UserID:this.$store.getters.userInfo_getters,CardNo:this.formItem.cardBoardNo}};this.$store.dispatch("getExecuteDropDownAction",e).then(function(e){t.cardScanQtyItems[t.formItem.cardBoardNo]=JSON.parse((0,r.default)(e.list)),e.list.forEach(function(o,e){var a=o.OrderNo;if(null!=t.cardBoardNoInfoClone[a]){var n=t.cardBoardNoInfoClone[a].ScanQty;t.cardBoardNoInfoClone[o.OrderNo].ScanQty=n+o.Qty,t.cardBoardNoInfoClone[o.OrderNo]["CardNo"]=t.formItem.cardBoardNo}}),t.formItem.cardBoardNo="",t.scanCard[o]="A"}).then(function(t){})}}})};o.default=g},"392c":function(t,o,e){"use strict";e.r(o);var a=e("37ec"),n=e.n(a);for(var i in a)"default"!==i&&function(t){e.d(o,t,function(){return a[t]})}(i);o["default"]=n.a},"45c4":function(t,o,e){"use strict";var a=function(){var t=this,o=t.$createElement,e=t._self._c||o;return e("v-uni-view",[e("cu-custom",{attrs:{bgColor:"bg-gradual-blue",isBack:!0}},[e("template",{attrs:{slot:"content"},slot:"content"},[t._v("备货出仓")])],2),t.appendModalShow?e("v-uni-view",{staticClass:"cu-modal show",staticStyle:{"z-index":"100"}},[e("v-uni-view",{staticClass:"cu-dialog"},[e("v-uni-view",{staticClass:"cu-bar bg-white justify-end"},[e("v-uni-view",{staticClass:"content"},[t._v("追加工单")]),e("v-uni-view",{staticClass:"action",on:{click:function(o){arguments[0]=o=t.$handleEvent(o),t.closeAppendModal.apply(void 0,arguments)}}},[e("v-uni-text",{staticClass:"cuIcon-close text-red"})],1)],1),e("v-uni-view",{staticClass:"padding-xl"},[e("v-uni-form",[e("v-uni-view",{staticClass:"cu-form-group "},[e("v-uni-input",{ref:"kuWeiInput",staticStyle:{"text-align":"left"},attrs:{placeholder:"请输入或扫描工单号",name:"input"},on:{blur:function(o){arguments[0]=o=t.$handleEvent(o),t.getStorageOrderDetail.apply(void 0,arguments)}},model:{value:t.appendModel.OrderNo,callback:function(o){t.$set(t.appendModel,"OrderNo",o)},expression:"appendModel.OrderNo"}}),e("v-uni-button",{staticClass:"cu-btn bg-green shadow",attrs:{loading:!1,type:""},on:{click:function(o){arguments[0]=o=t.$handleEvent(o),t.turnOnScanCode("OrderNo")}}},[t._v("扫描")])],1)],1),t.appendOkBtnDisabled?t._e():e("v-uni-view",[t._v("客户:"+t._s(t.appendRow.CustName)+"\n\t\t\t\t\t工单:"+t._s(t.appendRow.OrderNo)+"\n\t\t\t\t\t纸质:"+t._s(t.appendRow.ArtID)+"\n\t\t\t\t\t库位:"+t._s(t.appendRow.StationNo))])],1),e("v-uni-view",{staticClass:"cu-bar bg-white justify-end"},[e("v-uni-view",{staticClass:"action"},[e("v-uni-button",{staticClass:"cu-btn line-green text-green",on:{click:function(o){arguments[0]=o=t.$handleEvent(o),t.closeAppendModal.apply(void 0,arguments)}}},[t._v("取消")]),e("v-uni-button",{staticClass:"cu-btn bg-green margin-left",attrs:{disabled:t.appendOkBtnDisabled},on:{click:function(o){arguments[0]=o=t.$handleEvent(o),t.appendRowToList.apply(void 0,arguments)}}},[t._v("确定")])],1)],1)],1)],1):t._e(),e("v-uni-form",[e("v-uni-view",{ref:"elForm",staticClass:"elForm"},[e("v-uni-view",{staticClass:"cu-form-group border-top"},[e("v-uni-view",{staticClass:"title"},[t._v("装车单号:")]),e("v-uni-input",{attrs:{disabled:"",placeholder:"请选择装车单号",name:"input"},on:{click:function(o){arguments[0]=o=t.$handleEvent(o),t.getCarGoodsNo()}},model:{value:t.formItem.carGoodsNo,callback:function(o){t.$set(t.formItem,"carGoodsNo",o)},expression:"formItem.carGoodsNo"}}),e("v-uni-text",{staticClass:"cuIcon-rounddown text-green",on:{click:function(o){arguments[0]=o=t.$handleEvent(o),t.getCarGoodsNo()}}})],1),e("v-uni-view",{staticClass:"cu-form-group border-top"},[e("v-uni-view",{staticClass:"title"},[t._v("卡板号:")]),e("v-uni-input",{ref:"kuWeiInput",attrs:{placeholder:"请扫描卡板号",name:"input"},on:{blur:function(o){arguments[0]=o=t.$handleEvent(o),t.spFreshCarListForAPP.apply(void 0,arguments)}},model:{value:t.formItem.cardBoardNo,callback:function(o){t.$set(t.formItem,"cardBoardNo",o)},expression:"formItem.cardBoardNo"}}),e("v-uni-button",{staticClass:"cu-btn bg-green shadow",attrs:{loading:!1,disabled:0==t.cardBoardNoInfoData.length||""==t.formItem.carGoodsNo,type:""},on:{click:function(o){arguments[0]=o=t.$handleEvent(o),t.turnOnScanCode("cardBoardNo")}}},[t._v("扫描")])],1),e("v-uni-view",{staticClass:"cu-form-group border-top"},[e("v-uni-view",{staticClass:"cl-tableDesc"},[t._v("纸板明细清单")])],1)],1)],1),e("v-uni-view",{staticClass:"bingStorage-zTable"},[e("zTable",{attrs:{showSelect:!1,singleSelect:!0,onClickCheck:"onClickCheck",stickSide:!0,tableHeight:t.tableHeight,showLoading:!1,emptyText:t.errorContent,tableData:t.cardBoardNoInfoData,columns:t.cardBoardNoInfoColumns},on:{onClick:function(o){arguments[0]=o=t.$handleEvent(o),t.onClickRowEvent.apply(void 0,arguments)}}})],1),e("searchForm",{ref:"searchForm",attrs:{dataSource:t.dataSource},on:{getSelectDataInfo:function(o){arguments[0]=o=t.$handleEvent(o),t.getSelectDataInfo.apply(void 0,arguments)}}}),e("alertBox",{ref:"alertBox",attrs:{msgContent:t.msgContent,toShowModal:t.toShowModal},on:{cancelModal:function(o){arguments[0]=o=t.$handleEvent(o),t.cancelModal.apply(void 0,arguments)},comfirmModal:function(o){arguments[0]=o=t.$handleEvent(o),t.comfirmModal.apply(void 0,arguments)}}}),e("v-uni-view",{ref:"elBtn",staticClass:"elBtn margin-text-center"},[e("v-uni-view",{staticClass:"flex  p-xs "},[e("v-uni-view",{staticClass:"flex-twice radius"},[e("v-uni-button",{staticClass:"cu-btn block bg-green  lg",attrs:{loading:!1,type:"",disabled:""==t.formItem.carGoodsNo},on:{click:function(o){arguments[0]=o=t.$handleEvent(o),t.appendModalShow=!0}}},[t._v("追加工单")])],1),e("v-uni-view",{staticClass:"flex-sub radius"}),e("v-uni-view",{staticClass:"flex-twice  radius"},[e("v-uni-button",{staticClass:"cu-btn block bg-green  lg",attrs:{loading:!1,disabled:0==t.cardBoardNoInfoData.length,type:""},on:{click:function(o){arguments[0]=o=t.$handleEvent(o),t.goToOtherPage()}}},[t._v("出仓界面")])],1)],1)],1)],1)},n=[];e.d(o,"a",function(){return a}),e.d(o,"b",function(){return n})},b2a2:function(t,o,e){var a=e("bc9d");"string"===typeof a&&(a=[[t.i,a,""]]),a.locals&&(t.exports=a.locals);var n=e("4f06").default;n("3fa95112",a,!0,{sourceMap:!1,shadowMode:!1})},ba8a:function(t,o,e){"use strict";var a=e("b2a2"),n=e.n(a);n.a},bc9d:function(t,o,e){o=t.exports=e("2350")(!1),o.push([t.i,".margin-text-center[data-v-225b577c]{text-align:center;margin:%?20?%}.border-top[data-v-225b577c]{border-top:1px solid #eee}.cu-form-group .title[data-v-225b577c]{min-width:calc(4em + 15px)}",""])}}]);