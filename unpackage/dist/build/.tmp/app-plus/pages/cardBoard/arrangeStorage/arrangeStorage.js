(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/cardBoard/arrangeStorage/arrangeStorage"],{"09f0":function(t,e,n){"use strict";var o=function(){var t=this,e=t.$createElement;t._self._c},a=[];n.d(e,"a",function(){return o}),n.d(e,"b",function(){return a})},2584:function(t,e,n){},"381b":function(t,e,n){"use strict";n.r(e);var o=n("d349"),a=n.n(o);for(var r in o)"default"!==r&&function(t){n.d(e,t,function(){return o[t]})}(r);e["default"]=a.a},"517e":function(t,e,n){"use strict";var o=n("2584"),a=n.n(o);a.a},7957:function(t,e,n){"use strict";n.r(e);var o=n("09f0"),a=n("381b");for(var r in a)"default"!==r&&function(t){n.d(e,t,function(){return a[t]})}(r);n("517e");var i=n("2877"),c=Object(i["a"])(a["default"],o["a"],o["b"],!1,null,null,null);e["default"]=c.exports},aa4c:function(t,e,n){"use strict";(function(t){n("628f"),n("921b");o(n("66fd"));var e=o(n("7957"));function o(t){return t&&t.__esModule?t:{default:t}}t(e.default)}).call(this,n("6e42")["createPage"])},d349:function(t,e,n){"use strict";(function(t,o){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var a=c(n("a34a")),r=c(n("2464")),i=n("2f62");function c(t){return t&&t.__esModule?t:{default:t}}function s(t,e,n,o,a,r,i){try{var c=t[r](i),s=c.value}catch(u){return void n(u)}c.done?e(s):Promise.resolve(s).then(o,a)}function u(t){return function(){var e=this,n=arguments;return new Promise(function(o,a){var r=t.apply(e,n);function i(t){s(r,o,a,i,c,"next",t)}function c(t){s(r,o,a,i,c,"throw",t)}i(void 0)})}}function d(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{},o=Object.keys(n);"function"===typeof Object.getOwnPropertySymbols&&(o=o.concat(Object.getOwnPropertySymbols(n).filter(function(t){return Object.getOwnPropertyDescriptor(n,t).enumerable}))),o.forEach(function(e){l(t,e,n[e])})}return t}function l(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var f=function(){return n.e("components/color-ui-dialog/color-ui-dialog").then(n.bind(null,"43f7"))},h=function(){return Promise.all([n.e("common/vendor"),n.e("components/z-table/z-table")]).then(n.bind(null,"717c"))},m=function(){return n.e("components/uni-icon/uni-icon").then(n.bind(null,"6203"))},p=function(){return n.e("components/searchForm/searchDataList.vue").then(n.bind(null,"a99d"))},g=function(){return n.e("components/uni-popup/uni-popup").then(n.bind(null,"ad32"))},b={originalStationNo:"",originalBoardCard:"",orderNo:"",cardBoardNo:"",kuNo:""},I={name:"inStorage",mixins:[r.default],components:{zTable:h,searchForm:p,uniPopup:g,uniIcon:m,alertBox:f},data:function(){return{dataSource:[],currentAction:"",toShowModal:!1,msgContent:"",currentSelectItem:{},currentSelect:"line",originalBoardCardList:[],scanType:"",tableHeight:400,errorContent:"暂无数据",cardBoardNoInfoData:[],cardBoardNoInfoColumns:[{key:"ap_OrderNo",title:"工单号",width:200},{key:"ap_ArtID",title:"纸质",width:200},{key:"ap_Size",title:"规格",width:200},{key:"ap_Qty",title:"数量",width:145},{key:"ap_CustName",title:"客户",width:400},{title:"操作",listenerClick:!0,width:130,titleAlign:"center",columnAlign:"center",format:{template:"删除",names:[]}}],formItem:Object.assign({},b)}},onReady:function(){this.messageRegister(),this.getTableHeight()},methods:d({checkKuNo:function(){var t=u(a.default.mark(function t(){var e;return a.default.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,this.checkKuNoIsExist(this.formItem.kuNo);case 2:if(e=t.sent,!e){t.next=6;break}return this.formItem.kuNo="",t.abrupt("return");case 6:case"end":return t.stop()}},t,this)}));function e(){return t.apply(this,arguments)}return e}(),setSearchDataListSource:function(t){this.currentSelect=t,this.$refs["searchForm"].isShowSearchList=!0,"LicensePlate"===t&&(this.dataSource=this.originalBoardCardList,this.$refs["searchForm"].dataSourceList=this.originalBoardCardList)},getSelectDataInfo:function(t){switch(this.currentSelect){case"LicensePlate":this.formItem.originalBoardCard=t.ct_Desc;break;default:break}},comfirmModal:function(t){switch(this.toShowModal=!1,this.currentAction){case"preSubmitDataList":this.submitAddList();break;case"deleteDetailItem":this.deleteDetailItem();break;default:break}},cancelModal:function(t){this.toShowModal=!1},preSubmitDataList:function(){this.currentAction="preSubmitDataList",this.msgContent="确定更改库位吗?",this.toShowModal=!0},submitAddList:function(){var e=this,n={procName:"spPaperScanInfoChanged",params:{Type:"B",cardNo:this.formItem.cardBoardNo,newStationNo:this.formItem.kuNo,UserID:this.$store.getters.userInfo_getters,list:this.cardBoardNoInfoData}};this.$store.dispatch("updateStorehouseAction",n).then(function(n){e.formItem=Object.assign({},b),e.cardBoardNoInfoData=[],t.showToast({title:"操作成功",icon:"none",duration:2e3})}).catch(function(e){t.showToast({title:"操作失败:"+e,icon:"none",duration:2e3})})},deleteDetailItem:function(){var t=this,e=this.cardBoardNoInfoData.findIndex(function(e){return e.ap_OrderNo==t.currentSelectItem.ap_OrderNo});-1!=e&&this.cardBoardNoInfoData.splice(e,1)},onClickRowEvent:function(t){this.currentSelectItem=t,this.currentAction="deleteDetailItem",this.msgContent="确定删除当前数据吗?",this.toShowModal=!0},addWorkNoInfo:function(){var e=this;if(""!=this.formItem.workNo){var n={Identification:this.formItem.workNo};this.dataIsLoadding=!0,this.scanJobNoArrangeAction(n).then(function(n){e.getCardBoardNoInfo(),t.showToast({title:"扫描工单号成功",icon:"none",duration:2e3}),e.dataIsLoadding=!1}).catch(function(n){t.showToast({title:"获取数据失败:"+n,icon:"none",duration:2e3}),e.dataIsLoadding=!1})}else t.showToast({title:"请输入或扫描工单号",icon:"none",duration:2e3})},getTableHeight:function(){var t=u(a.default.mark(function t(){var e,n,o,r;return a.default.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return e=this,n=e.setTableHeight(),t.next=4,e.getOtherContentHeight("elForm");case 4:return o=t.sent,t.next=7,e.getOtherContentHeight("elBtn");case 7:r=t.sent,null!=o&&null!=r&&(e.tableHeight=n-o-r-20);case 9:case"end":return t.stop()}},t,this)}));function e(){return t.apply(this,arguments)}return e}()},(0,i.mapActions)(["getBoardDetailsAction","scanCardArrangeAction","scanJobNoArrangeAction","getExecuteDropDownDetailsAction"]),{messageRegister:function(){},getCardBoardNoInfo:function(){var t=this;this.checkCardBoardNo(this.formItem.cardBoardNo,"B").then(function(e){t.formItem.cardBoardNo}).catch(function(e){t.doAction()})},doAction:function(){var e=this;if(""!=this.formItem.cardBoardNo){var n={procName:"spGetCardInfoForAPP",params:{CardNo:this.formItem.cardBoardNo,Type:"B"}};this.cardBoardNoInfoData=[],this.dataIsLoadding=!0,this.getExecuteDropDownDetailsAction(n).then(function(n){if(n&&n.list&&n.list.length>0){e.cardBoardNoInfoData=n.list;var o=n.list.map(function(t){var e={type:t.ap_StationNo,ct_Desc:t.ap_StationNo};return e});e.originalBoardCardList=o,e.formItem.originalStationNo=n.list[0].ap_StationNo,e.formItem.originalBoardCard=o[0].ct_Desc}else t.showToast({title:"没有该卡板对应的数据",icon:"none",duration:2e3});e.dataIsLoadding=!1}).catch(function(n){t.showToast({title:"获取数据失败:"+n,icon:"none",duration:2e3}),e.dataIsLoadding=!1})}else t.showToast({title:"请输入或扫描卡板号",icon:"none",duration:2e3})},turnOnScanCode:function(e){this.scanType=e;var n=this;t.scanCode({scanType:"barCode",success:function(t){switch(console.log(o("条码内容："+t.result," at pages\\cardBoard\\arrangeStorage\\arrangeStorage.vue:366")),e){case"cardBoardNo":n.formItem.cardBoardNo=t.result,n.getCardBoardNoInfo();break;case"kuNo":n.formItem.kuNo=t.result;break;case"workNo":n.formItem.workNo=t.result,n.addWorkNoInfo();break;default:break}}})}})};e.default=I}).call(this,n("6e42")["default"],n("0de9")["default"])}},[["aa4c","common/runtime","common/vendor"]]]);