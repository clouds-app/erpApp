(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/cardBoard/loadGoodsDown/loadGoodsDownDetail"],{"387c":function(t,e,n){"use strict";var i=n("3b09"),o=n.n(i);o.a},"3b09":function(t,e,n){},"57dd":function(t,e,n){"use strict";n.r(e);var i=n("bdc2"),o=n.n(i);for(var r in i)"default"!==r&&function(t){n.d(e,t,function(){return i[t]})}(r);e["default"]=o.a},bdc2:function(t,e,n){"use strict";(function(t,i){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var o=u(n("a34a")),r=u(n("0a5c")),s=u(n("dcad")),a=u(n("2464")),c=n("2f62");function u(t){return t&&t.__esModule?t:{default:t}}function l(t,e,n,i,o,r,s){try{var a=t[r](s),c=a.value}catch(u){return void n(u)}a.done?e(c):Promise.resolve(c).then(i,o)}function d(t){return function(){var e=this,n=arguments;return new Promise(function(i,o){var r=t.apply(e,n);function s(t){l(r,i,o,s,a,"next",t)}function a(t){l(r,i,o,s,a,"throw",t)}s(void 0)})}}function f(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{},i=Object.keys(n);"function"===typeof Object.getOwnPropertySymbols&&(i=i.concat(Object.getOwnPropertySymbols(n).filter(function(t){return Object.getOwnPropertyDescriptor(n,t).enumerable}))),i.forEach(function(e){h(t,e,n[e])})}return t}function h(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var m=function(){return n.e("components/color-ui-dialog/color-ui-dialog").then(n.bind(null,"43f7"))},p=function(){return Promise.all([n.e("common/vendor"),n.e("components/z-table/z-table")]).then(n.bind(null,"717c"))},v=function(){return n.e("components/uni-icon/uni-icon").then(n.bind(null,"6203"))},g=function(){return n.e("components/searchForm/searchDataList.vue").then(n.bind(null,"a99d"))},L=function(){return n.e("components/uni-popup/uni-popup").then(n.bind(null,"ad32"))},D={entrucking:"",entruckingID:"",sendGoods:"",SenderID:"",deliverDate:(0,s.default)(Date.now()).format("YYYY-MM-DD"),isSelfTake:!1,LicensePlate:"",driver:"",driverID:""},b={name:"inStorage",mixins:[a.default],components:{zTable:p,searchForm:g,uniPopup:L,uniIcon:v,alertBox:m},data:function(){return{canSubmit:!0,currentAction:"",CarListNo:"",cardNo:"",toShowModal:!1,msgContent:"",dataSource:[],currentSelect:"driver",tableHeight:400,licensePlateList:[],driverList:[],entruckingList:[],sendGoodsList:[],formItem:Object.assign({},D)}},onLoad:function(t){this.cardNo=t.cardNo,this.CarListNo=t.carListNo},onReady:function(){this.messageRegister(),this.getTableHeight()},methods:f({comfirmModal:function(t){switch(this.toShowModal=!1,this.currentAction){case"sendPrintActionToERP":this.sendPrintActionToERP();break;default:break}},cancelModal:function(t){this.toShowModal=!1},sendPrintActionToERP:function(){var t=this.$store.getters.userObjInfo_getters,e=t.ip,n=t.port,i=t.UserID,o="http://".concat(e,":").concat(n,"/indexhtml?userID=").concat(i,",LoadCarNo=").concat(this.CarListNo),s={};return new Promise(function(t,e){r.default.request({"Content-Type":"application/json;charset=UTF-8",url:o,data:s,method:"POST"}).then(function(e){e&&t(e)}).catch(function(t){t&&e(t)})})}},(0,c.mapActions)(["spCreatePaperCarListAppAction","getAspCarListAppAppendAction"]),{saveWarehouses:function(){var e=this,n={procName:"spSaveCarListToDeliForAPP",params:{UserID:this.$store.getters.userInfo_getters,CarListNo:this.CarListNo,CarNo:this.formItem.LicensePlate,Chauffeur:this.formItem.driverID,Loador:this.formItem.entruckingID,SenderID:this.formItem.SenderID,IsZT:1==this.formItem.isSelfTake?1:0,ADate:this.formItem.deliverDate+" "+(0,s.default)(Date.now()).format("HH:mm:ss")}};this.$store.dispatch("setWarehousesAction",n).then(function(n){if(n&&n.list&&n.list.length>0){if(1===n.list[0].Error)return void t.showToast({title:"保存出仓失败:"+n.list[0].Result,icon:"none",duration:2e3});e.canSubmit=!1,t.showModal({title:"提示",content:"保存出仓成功",showCancel:!1,success:function(e){e.confirm&&t.navigateTo({url:"./loadGoodsDown"})}})}}).catch(function(e){t.showToast({title:"保存出仓失败:"+e,icon:"none",duration:2e3})})},aspCarListAppAppend:function(e){var n;try{var o="outInCarList";n=t.getStorageSync(o),n&&console.log(i(n," at pages\\cardBoard\\loadGoodsDown\\loadGoodsDownDetail.vue:253"))}catch(s){}var r={UserID:this.$store.getters.userInfo_getters,list:n};this.$store.dispatch("spCreatePaperCarListAppAction",r).then(function(t){e&&e()}).catch(function(e){t.showToast({title:"保存出仓失败:"+e,icon:"none",duration:2e3})})},isSelfTakeChange:function(t){this.formItem.isSelfTake=t.detail.value},formatMultipleVal:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"desc",n="";t.map(function(t){""==n?n="desc"==e?t.ct_Desc:t.type:n+="desc"==e?";"+t.ct_Desc:";"+t.type});return n},getSelectDataInfo:function(t){switch(this.currentSelect){case"LicensePlate":this.formItem.LicensePlate=t.ct_Desc;break;case"driver":this.formItem.driverID=t.type,this.formItem.driver=t.ct_Desc;break;case"entrucking":this.formItem.entruckingID=this.formatMultipleVal(t,"type"),this.formItem.entrucking=this.formatMultipleVal(t,"desc");break;case"sendGoods":this.formItem.SenderID=t.type,this.formItem.sendGoods=t.ct_Desc;default:break}},setSearchDataListSource:function(t){this.currentSelect=t,this.$refs["searchForm"].isMultipel=!1,this.$refs["searchForm"].isShowSearchList=!0,"LicensePlate"===t?(this.dataSource=this.licensePlateList,this.$refs["searchForm"].dataSourceList=this.licensePlateList):"driver"===t?(this.dataSource=this.driverList,this.$refs["searchForm"].dataSourceList=this.driverList):"entrucking"===t?(this.$refs["searchForm"].isMultipel=!0,this.dataSource=this.entruckingList,this.$refs["searchForm"].dataSourceList=this.entruckingList):"sendGoods"===t&&(this.dataSource=this.sendGoodsList,this.$refs["searchForm"].dataSourceList=this.sendGoodsList)},loadLicensePlateList:function(){var e=this;this.licensePlateList=[];var n={};this.$store.dispatch("getLicensePlateListAction",n).then(function(t){if(t){var n=t.map(function(t){var e={type:t.CarNo,ct_Desc:t.CarNo};return e});e.licensePlateList=n,e.setDefaultLicensePlate()}}).catch(function(e){t.showToast({title:"加载车牌列表失败:"+e,icon:"none",duration:2e3})})},setDefaultLicensePlate:function(){var t=this;if(this.licensePlateList.length>0&&""!=this.cardNo){var e=this.licensePlateList.find(function(e){return e.ct_Desc==t.cardNo});this.formItem.LicensePlate=null!=e?e.ct_Desc:this.cardNo}},loadDriverList:function(){var e=this;this.driverList=[];var n={};this.$store.dispatch("getDriverListAction",n).then(function(t){if(t){var n=t.map(function(t){var e={type:t.ID,ct_Desc:t.Name};return e});e.driverList=n}}).catch(function(e){t.showToast({title:"加载司机列表失败:"+e,icon:"none",duration:2e3})})},loadEntruckingList:function(){var e=this;this.entruckingList=[];var n={};this.$store.dispatch("getEntruckingListAction",n).then(function(t){if(t){var n=t.map(function(t){var e={type:t.ID,ct_Desc:t.Name};return e});e.entruckingList=n}}).catch(function(e){t.showToast({title:"加载装货列表失败:"+e,icon:"none",duration:2e3})})},loadsendGoodsList:function(){var e=this;this.sendGoodsList=[];var n={};this.$store.dispatch("getSendGoodsListAction",n).then(function(t){if(t){var n=t.map(function(t){var e={type:t.ID,ct_Desc:t.Name};return e});e.sendGoodsList=n}}).catch(function(e){t.showToast({title:"加载发货列表失败:"+e,icon:"none",duration:2e3})})},DateChange:function(t){this.formItem.deliverDate=t.detail.value},getTableHeight:function(){var t=d(o.default.mark(function t(){var e,n,i,r;return o.default.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return e=this,n=e.setTableHeight(),t.next=4,e.getOtherContentHeight("elForm");case 4:return i=t.sent,t.next=7,e.getOtherContentHeight("elBtn");case 7:r=t.sent,null!=i&&null!=r&&(e.tableHeight=n-i-r-20);case 9:case"end":return t.stop()}},t,this)}));function e(){return t.apply(this,arguments)}return e}()},(0,c.mapActions)(["getClassBanListAction"]),{messageRegister:function(){this.canSubmit=!0,this.loadLicensePlateList(),this.loadDriverList(),this.loadEntruckingList(),this.loadsendGoodsList()},turnOnScanCode:function(e){this.scanType=e;var n=this;t.scanCode({scanType:"barCode",success:function(t){switch(console.log(i("条码内容："+t.result," at pages\\cardBoard\\loadGoodsDown\\loadGoodsDownDetail.vue:507")),e){case"cardBoardNo":n.formItem.cardBoardNo=t.result;break;case"kuNo":n.formItem.kuNo=t.result;break;default:break}}})}})};e.default=b}).call(this,n("6e42")["default"],n("0de9")["default"])},c055:function(t,e,n){"use strict";(function(t){n("628f"),n("921b");i(n("66fd"));var e=i(n("d005"));function i(t){return t&&t.__esModule?t:{default:t}}t(e.default)}).call(this,n("6e42")["createPage"])},d005:function(t,e,n){"use strict";n.r(e);var i=n("e850"),o=n("57dd");for(var r in o)"default"!==r&&function(t){n.d(e,t,function(){return o[t]})}(r);n("387c");var s,a=n("f0c5"),c=Object(a["a"])(o["default"],i["b"],i["c"],!1,null,null,null,!1,i["a"],s);e["default"]=c.exports},e850:function(t,e,n){"use strict";var i,o=function(){var t=this,e=t.$createElement;t._self._c},r=[];n.d(e,"b",function(){return o}),n.d(e,"c",function(){return r}),n.d(e,"a",function(){return i})}},[["c055","common/runtime","common/vendor"]]]);