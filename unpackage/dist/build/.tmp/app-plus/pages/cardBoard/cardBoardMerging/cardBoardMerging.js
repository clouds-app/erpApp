(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/cardBoard/cardBoardMerging/cardBoardMerging"],{"43b6":function(t,e,o){"use strict";var n,r=function(){var t=this,e=t.$createElement;t._self._c},a=[];o.d(e,"b",function(){return r}),o.d(e,"c",function(){return a}),o.d(e,"a",function(){return n})},"44e0":function(t,e,o){"use strict";var n=o("c8c1"),r=o.n(n);r.a},5987:function(t,e,o){"use strict";o.r(e);var n=o("ce11"),r=o.n(n);for(var a in n)"default"!==a&&function(t){o.d(e,t,function(){return n[t]})}(a);e["default"]=r.a},"65ef":function(t,e,o){"use strict";(function(t){o("628f"),o("921b");n(o("66fd"));var e=n(o("cff4"));function n(t){return t&&t.__esModule?t:{default:t}}t(e.default)}).call(this,o("6e42")["createPage"])},c8c1:function(t,e,o){},ce11:function(t,e,o){"use strict";(function(t){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var n=a(o("a34a")),r=(a(o("0a5c")),a(o("dcad")),a(o("2464")));o("2f62");function a(t){return t&&t.__esModule?t:{default:t}}function i(t,e,o,n,r,a,i){try{var c=t[a](i),u=c.value}catch(s){return void o(s)}c.done?e(u):Promise.resolve(u).then(n,r)}function c(t){return function(){var e=this,o=arguments;return new Promise(function(n,r){var a=t.apply(e,o);function c(t){i(a,n,r,c,u,"next",t)}function u(t){i(a,n,r,c,u,"throw",t)}c(void 0)})}}var u=function(){return o.e("components/color-ui-dialog/color-ui-dialog").then(o.bind(null,"43f7"))},s=function(){return Promise.all([o.e("common/vendor"),o.e("components/z-table/z-table")]).then(o.bind(null,"717c"))},d=function(){return o.e("components/uni-icon/uni-icon").then(o.bind(null,"6203"))},f=function(){return o.e("components/searchForm/searchDataList.vue").then(o.bind(null,"a99d"))},m=function(){return o.e("components/uni-popup/uni-popup").then(o.bind(null,"ad32"))},l={workNo:"",cardBoardNo:"",cardBoardID:"",cardBoardNum:0,newcardBoardNo:"",newcardBoardID:"",newcardBoardNum:0},h={name:"cardBoardMerging",mixins:[r.default],components:{zTable:s,searchForm:f,uniPopup:m,uniIcon:d,alertBox:u},data:function(){return{cardBoardList:[],toShowModal:!1,currentAction:"",msgContent:"",dataSource:[],currentSelect:"driver",tableHeight:400,formItem:Object.assign({},l)}},computed:{canScanCardBoard:function(){return!(""!=this.formItem.workNo)},canSubmitData:function(){return!(""!=this.formItem.workNo&&""!=this.formItem.cardBoardNo&&""!=this.formItem.newcardBoardNo&&0!=this.totalMergingNum&&this.formItem.cardBoardNum>0&&this.formItem.newcardBoardNum>0)},totalMergingNum:function(){return Number(this.formItem.cardBoardNum)+Number(this.formItem.newcardBoardNum)}},onReady:function(){this.messageRegister(),this.getTableHeight()},methods:{messageRegister:function(){},preSubmitData:function(){this.currentAction="preSubmitData",this.msgContent="确定提交数据吗?",this.toShowModal=!0},SubmitData:function(){var e=this,o={procName:"spPaperScanMergeChanged",params:{OldID:this.formItem.cardBoardID,NewID:this.formItem.newcardBoardID,OrderNo:this.formItem.workNo,Num:this.formItem.cardBoardNum,UserID:this.$store.getters.userInfo_getters}};this.$store.dispatch("getExecuteDropDownAction",o).then(function(o){t.showToast({title:"合并卡板成功",icon:"none",duration:2e3}),e.formItem=Object.assign({},l)}).catch(function(e){t.showToast({title:"合并卡板失败:"+e,icon:"none",duration:2e3})})},comfirmModal:function(t){switch(this.toShowModal=!1,this.currentAction){case"preSubmitData":this.SubmitData();break;default:break}},cancelModal:function(t){this.toShowModal=!1},getSelectDataInfo:function(t){switch(this.currentSelect){case"LicensePlate":this.formItem.LicensePlate=t.ct_Desc;break;default:break}},getTableHeight:function(){var t=c(n.default.mark(function t(){var e,o,r,a;return n.default.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return e=this,o=e.setTableHeight(),t.next=4,e.getOtherContentHeight("elForm");case 4:return r=t.sent,t.next=7,e.getOtherContentHeight("elBtn");case 7:a=t.sent,null!=r&&null!=a&&(e.tableHeight=o-r-a-20);case 9:case"end":return t.stop()}},t,this)}));function e(){return t.apply(this,arguments)}return e}(),checkWorkNoInfo:function(){var e=this;if(""!=this.formItem.workNo){var o={ap_OrderNo:this.formItem.workNo};this.$store.dispatch("orderNoCheckAction",o).then(function(o){null==o&&(t.showToast({title:"此工单号未入库,不能进行合并!",icon:"none",duration:2e3}),e.formItem.workNo="")}).catch(function(e){t.showToast({title:"获取工单数据失败:"+e,icon:"none",duration:2e3})})}else t.showToast({title:"请扫描工单号",icon:"none",duration:2e3})},getCardBoardNoInfo:function(){var e=this;if(""!=this.formItem.workNo)if(""!=this.formItem.cardBoardNo){var o={ap_OrderNo:this.formItem.workNo,ap_CardNo:this.formItem.cardBoardNo};this.$store.dispatch("getCardBoardNumbeByAction",o).then(function(o){null!=o?(e.formItem.cardBoardID=o.ID1,e.formItem.cardBoardNum=o.ap_Qty):(t.showToast({title:"不是在库的卡板,请检查!",icon:"none",duration:2e3}),e.formItem.cardBoardNum=0)}).catch(function(e){t.showToast({title:"获取新卡板数据失败:"+e,icon:"none",duration:2e3})})}else t.showToast({title:"请扫描原卡板",icon:"none",duration:2e3});else t.showToast({title:"请先扫描工单号",icon:"none",duration:2e3})},getNewCardBoardNoInfo:function(){var e=this;if(""!=this.formItem.workNo)if(""!=this.formItem.newcardBoardNo){var o={ap_OrderNo:this.formItem.workNo,ap_CardNo:this.formItem.newcardBoardNo};this.$store.dispatch("getCardBoardNumbeByAction",o).then(function(o){null!=o?(e.formItem.newcardBoardID=o.ID1,e.formItem.newcardBoardNum=o.ap_Qty):(t.showToast({title:"不是在库的卡板,请检查!",icon:"none",duration:2e3}),e.formItem.newcardBoardNum=0)}).catch(function(e){t.showToast({title:"获取新卡板数据失败:"+e,icon:"none",duration:2e3})})}else t.showToast({title:"请扫描新卡板",icon:"none",duration:2e3});else t.showToast({title:"请先扫描工单号",icon:"none",duration:2e3})},turnOnScanCode:function(e){this.scanType=e;var o=this;t.scanCode({scanType:"barCode",success:function(t){switch(e){case"workNo":o.formItem.workNo=t.result,o.checkWorkNoInfo();break;case"cardBoardNo":o.formItem.cardBoardNo=t.result,o.getCardBoardNoInfo();break;case"newcardBoardNo":o.formItem.newcardBoardNo=t.result,o.getNewCardBoardNoInfo();break;default:break}}})}}};e.default=h}).call(this,o("6e42")["default"])},cff4:function(t,e,o){"use strict";o.r(e);var n=o("43b6"),r=o("5987");for(var a in r)"default"!==a&&function(t){o.d(e,t,function(){return r[t]})}(a);o("44e0");var i,c=o("f0c5"),u=Object(c["a"])(r["default"],n["b"],n["c"],!1,null,null,null,!1,n["a"],i);e["default"]=u.exports}},[["65ef","common/runtime","common/vendor"]]]);