(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/warehouse/boxIn/boxIn"],{"29e4":function(t,o,e){"use strict";e.r(o);var n=e("5063"),r=e.n(n);for(var i in n)"default"!==i&&function(t){e.d(o,t,function(){return n[t]})}(i);o["default"]=r.a},"36a8":function(t,o,e){},5063:function(t,o,e){"use strict";(function(t,n){Object.defineProperty(o,"__esModule",{value:!0}),o.default=void 0;var r=s(e("2464")),i=e("2f62");function s(t){return t&&t.__esModule?t:{default:t}}function a(t){return u(t)||l(t)||c()}function c(){throw new TypeError("Invalid attempt to spread non-iterable instance")}function l(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}function u(t){if(Array.isArray(t)){for(var o=0,e=new Array(t.length);o<t.length;o++)e[o]=t[o];return e}}function b(t){for(var o=1;o<arguments.length;o++){var e=null!=arguments[o]?arguments[o]:{},n=Object.keys(e);"function"===typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(e).filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.forEach(function(o){f(t,o,e[o])})}return t}function f(t,o,e){return o in t?Object.defineProperty(t,o,{value:e,enumerable:!0,configurable:!0,writable:!0}):t[o]=e,t}var h=function(){return e.e("components/uni-popup/uni-popup").then(e.bind(null,"ad32"))},d=function(){return Promise.all([e.e("common/vendor"),e.e("components/z-table/z-table")]).then(e.bind(null,"717c"))},m={name:"boxIn",mixins:[r.default],components:{zTable:d,uniPopup:h},data:function(){return{currentSelected:"-1",TabCur:0,scanType:"",scrollLeft:0,dataTableList:[],errorContent:"暂无数据",tableHeight:400,boxIn:{formItem:{bi_WorkNo:"",bi_Group:"",bi_InQty:"",ct_Desc:"",bi_ProdName:"",Specs:"",bp_CBoxID:"",bp_PArtID:"",bp_ArtLB:"",bp_ProQty:""},formItemInit:{bi_WorkNo:"",bi_Group:"",bi_InQty:"",ct_Desc:"",bi_ProdName:"",Specs:"",bp_CBoxID:"",bp_PArtID:"",bp_ArtLB:"",bp_ProQty:""},dataIsLoadding:!1},boxOut:{formItem:{bd_CarNo:"",bd_Follower:"",bd_Loador:"",bd_SenderID:"",bi_OrderNo:"",bi_OrderQty:""},formItemText:{bd_CarNo:"",bd_Follower:"",bd_Loador:"",bd_SenderID:""},formItemInit:{bd_CarNo:"",bd_Follower:"",bd_Loador:"",bd_SenderID:"",bi_OrderNo:"",bi_OrderQty:""},car:{items:[],show:!1},follower:{items:[],show:!1},loader:{items:[],show:!1},sender:{items:[],show:!1},tableData:[]},boxInc:{formItem:{hp_wpl_Id:"",hp_mo_ID:"",hp_tt_Code:"",hp_bi_WorkNo:"",Qty:"",Remark:"",ct_Desc:"",bi_ProdName:"",Specs:"",bp_ProQty:""},formItemInit:{hp_wpl_Id:"",hp_mo_ID:"",hp_tt_Code:"",hp_bi_WorkNo:"",Qty:"",Remark:"",ct_Desc:"",bi_ProdName:"",Specs:"",bp_ProQty:""},dataIsLoadding:!1},tableColumns:[{key:"bc_No",title:"订单号",width:180,isResize:!0},{key:"ct_Desc",title:"客户名称",width:200,isResize:!0},{key:"bi_ProdName",title:"产品名称",width:200,isResize:!0},{key:"bi_OrderQty",title:"数量",width:180,isResize:!0},{key:"Specs",title:"规格",width:180,isResize:!0}]}},onReady:function(){this.messageRegister()},methods:b({},(0,i.mapActions)(["boxScanOrderAction","aspSaveBoxInAction","findUserAction","findCarAction","aspSaveBoxOutTempAction","aspSaveBoxHalfProdInAction"]),{messageRegister:function(){var o=this;t.$on("getSelectData",function(t){switch(o.currentSelected){case"车牌号":o.carConfirm(t.msg);break;case"跟车员":o.followerConfirm(t.msg);break;case"装车员":o.loaderConfirm(t.msg);break;case"发货员":o.senderConfirm(t.msg);break;default:break}})},tabSelect:function(t){var o=this;switch(this.TabCur=t.currentTarget.dataset.id,this.scrollLeft=60*(t.currentTarget.dataset.id-1),this.TabCur){case 0:break;case"1":this.$nextTick(function(){o.getOtherContentHeight(),setTimeout(function(){var t=o.setTableHeight(!0);o.tableHeight=t-130},200)});break;case"2":break;default:break}},turnToPageDataSelect:function(o,e){this.currentSelected=e,this.$store.commit("setDataSelectedPageTitle",e),this.$store.commit("setDataSelectedList",o),t.navigateTo({url:"/components/list-select/list-select"})},boxInGetOrderInfo:function(){var o=this;if(""!=this.boxIn.formItem.bi_WorkNo){var e={bi_WorkNo:this.boxIn.formItem.bi_WorkNo,Flag:0};this.boxIn.dataIsLoadding=!1,this.boxScanOrderAction(e).then(function(e){if(e.list&&e.list.length>0)return Object.assign(o.boxIn.formItem,e.list[0]),void(o.boxIn.dataIsLoadding=!0);t.showToast({title:"没有该工单对应的数据",icon:"none",duration:2e3})}).catch(function(e){o.errorContent="暂无数据",t.showToast({title:"获取数据失败:"+e,icon:"none",duration:2e3})})}else t.showToast({title:"请输入或扫描工单号",icon:"none",duration:2e3})},boxInAspSaveBoxIn:function(){var o=this;if(""!=this.boxIn.formItem.bi_WorkNo)if(""!=this.boxIn.formItem.bi_Group)if(""!=this.boxIn.formItem.bi_InQty){var e={bi_WorkNo:this.boxIn.formItem.bi_WorkNo,bi_Group:this.boxIn.formItem.bi_Group,bi_InQty:this.boxIn.formItem.bi_InQty};this.aspSaveBoxInAction(e).then(function(e){if(e.list.length>0)return e.list[0].ErrorStr&&""!=e.list[0].ErrorStr?void t.showModal({title:"提示",content:e.list[0].ErrorStr,showCancel:!1}):(t.showModal({title:"提示",content:"入库成功",showCancel:!1}),void(o.boxIn.formItem=JSON.parse(JSON.stringify(o.boxIn.formItemInit))));t.showModal({title:"提示",content:"入库失败",showCancel:!1})}).catch(function(o){t.showToast({title:"入库失败:"+o,icon:"none",duration:2e3})})}else t.showToast({title:"请输入数量",icon:"none",duration:2e3});else t.showToast({title:"请输入班别",icon:"none",duration:2e3});else t.showToast({title:"请输入或扫描工单号",icon:"none",duration:2e3})},boxOutGetBaseInfo:function(o){var e=this;return new Promise(function(n,r){e.findUserAction(o).then(function(t){n(t)}).catch(function(o){t.showToast({title:"获取数据失败:"+o,icon:"none",duration:2e3}),r(o)})})},getCarInfo:function(){var o=this;"车牌号"===this.currentSelected&&this.boxOut.car.items.length>0?t.navigateTo({url:"/components/list-select/list-select"}):this.findCarAction().then(function(t){o.boxOut.car.items=t.list,o.boxOut.car.show=!0,o.turnToPageDataSelect(t.list,"车牌号")}).catch(function(o){t.showToast({title:"获取数据失败:"+o,icon:"none",duration:2e3})})},carConfirm:function(t){this.boxOut.formItem.bd_CarNo=t.value,this.boxOut.formItemText.bd_CarNo=t.text,this.boxOut.car.show=!1},getFollowerInfo:function(){var o=this;if("跟车员"===this.currentSelected&&this.boxOut.follower.items.length>0)return t.navigateTo({url:"/components/list-select/list-select"}),void(this.boxOut.follower.show=!0);this.boxOutGetBaseInfo({workType:"5,18"}).then(function(t){o.boxOut.follower.items=t.list,o.boxOut.follower.show=!0,o.turnToPageDataSelect(t.list,"跟车员")})},followerConfirm:function(t){this.boxOut.formItem.bd_Follower=t.value,this.boxOut.formItemText.bd_Follower=t.text,this.boxOut.follower.show=!1},getLoaderInfo:function(){var o=this;if("装车员"===this.currentSelected&&this.boxOut.loader.items.length>0)return t.navigateTo({url:"/components/list-select/list-select"}),void(this.boxOut.loader.show=!0);this.boxOutGetBaseInfo({workType:"6,18"}).then(function(t){o.boxOut.loader.items=t.list,o.boxOut.loader.show=!0,o.turnToPageDataSelect(t.list,"装车员")})},loaderConfirm:function(t){this.boxOut.formItem.bd_Loador=t.value,this.boxOut.formItemText.bd_Loador=t.text,this.boxOut.loader.show=!1},getSenderInfo:function(){var o=this;if("发货员"===this.currentSelected&&this.boxOut.sender.items.length>0)return t.navigateTo({url:"/components/list-select/list-select"}),void(this.boxOut.sender.show=!0);this.boxOutGetBaseInfo({workType:"2,18"}).then(function(t){o.boxOut.sender.items=t.list,o.boxOut.sender.show=!0,o.turnToPageDataSelect(t.list,"发货员")})},senderConfirm:function(t){this.boxOut.formItem.bd_SenderID=t.value,this.boxOut.formItemText.bd_SenderID=t.text,this.boxOut.sender.show=!1},boxOutGetOrderInfo:function(){var o=this;if(""!=this.boxOut.formItem.bi_OrderNo)if(""!=this.boxOut.formItem.bi_OrderQty){for(var e=0;e<this.boxOut.tableData.length;e++){var n=this.boxOut.tableData[e];if(n.bc_No==this.boxOut.formItem.bi_OrderNo)return this.boxOut.formItem.bi_OrderNo="",void t.showToast({title:"订单已存在",icon:"none",duration:2e3})}var r={bc_No:this.boxOut.formItem.bi_OrderNo,Flag:1};this.errorContent="数据加载中...",this.boxScanOrderAction(r).then(function(e){if(e.list&&e.list.length>0){var n=e.list[0];return n.bi_OrderQty=o.boxOut.formItem.bi_OrderQty,void(o.boxOut.tableData=[].concat(a(o.boxOut.tableData),[n]))}o.errorContent="暂无数据",t.showToast({title:"没有该订单号对应的数据",icon:"none",duration:2e3})}).catch(function(e){o.errorContent="暂无数据",t.showToast({title:"获取数据失败:"+e,icon:"none",duration:2e3})})}else t.showToast({title:"请输入数量",icon:"none",duration:2e3});else t.showToast({title:"请输入订单号",icon:"none",duration:2e3})},aspSaveBoxOutTemp:function(){var o=this,e=[],n=[];if(this.boxOut.tableData.forEach(function(t,o){e.push(t.bc_No),n.push(t.bi_OrderQty)}),0!=e.length&&0!=n&&e.length==n.length){var r={bd_CarNo:this.boxOut.formItem.bd_CarNo,bd_Follower:this.boxOut.formItem.bd_Follower,bd_Loador:this.boxOut.formItem.bd_Loador,bd_SenderID:this.boxOut.formItem.bd_SenderID,OrderQtyStr:n.toString(),NoStr:e.toString()};this.aspSaveBoxOutTempAction(r).then(function(e){if(e.list.length>0)return e.list[0].ErrorStr&&""!=e.list[0].ErrorStr?void t.showModal({title:"提示",content:e.list[0].ErrorStr,showCancel:!1}):(t.showModal({title:"提示",content:"出仓成功",showCancel:!1}),o.boxOut.formItem=JSON.parse(JSON.stringify(o.boxOut.formItemInit)),void(o.boxOut.tableData=[]));t.showModal({title:"提示",content:"出仓失败",showCancel:!1})}).catch(function(e){o.errorContent="暂无数据",t.showToast({title:"获取数据失败:"+e,icon:"none",duration:2e3})})}else t.showToast({title:"数据不能为空,提交数据不完整",icon:"none",duration:2e3})},boxIncGetOrderInfo:function(){var o=this;if(""!=this.boxInc.formItem.hp_bi_WorkNo){var e={bi_WorkNo:this.boxInc.formItem.hp_bi_WorkNo,Flag:0};this.boxInc.dataIsLoadding=!1,this.boxScanOrderAction(e).then(function(e){if(e.list&&e.list.length>0)return Object.assign(o.boxInc.formItem,e.list[0]),void(o.boxInc.dataIsLoadding=!0);t.showToast({title:"没有该工单对应的数据",icon:"none",duration:2e3})}).catch(function(o){t.showToast({title:"验证工单号是否存在失败:"+o,icon:"none",duration:2e3})})}else t.showToast({title:"请输入或扫描工单号",icon:"none",duration:2e3})},aspSaveBoxHalfProdIn:function(){var o=this;if(""!=this.boxInc.formItem.hp_bi_WorkNo){if(""==this.boxInc.formItem.Qty)return t.showToast({title:"请输入数量",icon:"none",duration:2e3}),void this.$refs.boxInc_qty.focus();var e={hp_bi_WorkNo:this.boxInc.formItem.hp_bi_WorkNo,hp_wpl_Id:this.boxInc.formItem.hp_wpl_Id,hp_mo_ID:this.boxInc.formItem.hp_mo_ID,hp_tt_Code:this.boxInc.formItem.hp_tt_Code,Qty:this.boxInc.formItem.Qty,Remark:this.boxInc.formItem.Remark};this.aspSaveBoxHalfProdInAction(e).then(function(e){if(e.list.length>0)return e.list[0].ErrorStr&&""!=e.list[0].ErrorStr?void t.showModal({title:"提示",content:e.list[0].ErrorStr,showCancel:!1}):(t.showModal({title:"提示",content:"入仓成功",showCancel:!1}),void(o.boxInc.formItem=JSON.parse(JSON.stringify(o.boxInc.formItemInit))));t.showModal({title:"提示",content:"入仓失败",showCancel:!1})}).catch(function(e){o.errorContent="暂无数据",t.showToast({title:"获取数据失败:"+e,icon:"none",duration:2e3})})}else t.showToast({title:"请输入或扫描工单号",icon:"none",duration:2e3})},turnOnScanCode:function(o){this.scanType=o;var e=this;t.scanCode({scanType:"barCode",success:function(t){switch(console.log(n("条码内容："+t.result," at pages\\warehouse\\boxIn\\boxIn.vue:867")),e.TabCur){case 0:e.boxIn.formItem.bi_WorkNo=t.result,e.boxInGetOrderInfo();break;case 1:e.boxOut.formItem.bi_OrderNo=t.result;break;case 2:e.boxInc.formItem.hp_bi_WorkNo=t.result,e.boxIncGetOrderInfo();break;default:break}}})}})};o.default=m}).call(this,e("6e42")["default"],e("0de9")["default"])},"6a9e":function(t,o,e){"use strict";(function(t){e("628f"),e("921b");n(e("66fd"));var o=n(e("e20a"));function n(t){return t&&t.__esModule?t:{default:t}}t(o.default)}).call(this,e("6e42")["createPage"])},"8a6a":function(t,o,e){"use strict";var n=e("36a8"),r=e.n(n);r.a},"8f73":function(t,o,e){"use strict";var n=function(){var t=this,o=t.$createElement;t._self._c},r=[];e.d(o,"a",function(){return n}),e.d(o,"b",function(){return r})},e20a:function(t,o,e){"use strict";e.r(o);var n=e("8f73"),r=e("29e4");for(var i in r)"default"!==i&&function(t){e.d(o,t,function(){return r[t]})}(i);e("8a6a");var s=e("2877"),a=Object(s["a"])(r["default"],n["a"],n["b"],!1,null,null,null);o["default"]=a.exports}},[["6a9e","common/runtime","common/vendor"]]]);